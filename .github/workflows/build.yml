name: Build and Push Theia Images

on:
  pull_request:
    branches:
      - master

  push:
    branches:
      - master

  release:
    types:
      - published
      - prereleased

  workflow_dispatch:

concurrency:
  group: ${{ github.workflow }}-${{ github.event.pull_request.number || github.ref }}
  cancel-in-progress: false

jobs:
  # ARC self-hosted runners (fast, with Verdaccio/registry/proxy caching)
  arc:
    uses: ./.github/workflows/arc-runner.yml
    secrets: inherit

  # GitHub-hosted runners (slower, no cluster dependencies, reliable fallback)
  github-hosted:
    uses: ./.github/workflows/github-runner.yml
    secrets: inherit
